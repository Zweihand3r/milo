import{a as E}from"./chunk-I5JF36TS.js";import"./chunk-VP5VJMKQ.js";import"./chunk-YBWLHNHN.js";var u,r,k,T,x,$,G=e=>{let t=r("ol");e.forEach(i=>{let a=r("li",null,i);t.appendChild(a)});let s=r("div",null,t),n=r("div",null,s),o=r("div",{class:"tabs quiet"},n);return r("div",{class:"section tabs-background-transparent"},o)},P=(e,t)=>{let s=r("div",null,"tab"),n=r("div",null,t),o=r("div");o.appendChild(s),o.appendChild(n);let i=r("div",{class:"section-metadata"},o),a=r("div",{class:"section"});return a.append(e),a.append(i),a},y=e=>document.cookie.split("; ").find(t=>t.startsWith(`${e}=`))?.split("=")[1],_=()=>new Promise((e,t)=>{let n=new URLSearchParams(window.location.search).get("akamaiLocale")||sessionStorage.getItem("akamai");n!==null?e(n.toLowerCase()):fetch("https://geo2.adobe.com/json/",{cache:"no-cache"}).then(o=>{o.ok?o.json().then(i=>{let a=i.country.toLowerCase();sessionStorage.setItem("akamai",a),e(a)}):t(new Error(`Something went wrong getting the akamai Code. Response status text: ${o.statusText}`))}).catch(o=>{t(new Error(`Something went wrong getting the akamai Code. ${o.message}`))})});async function j(e){let t=k("fallbackrouting")||u.fallbackRouting,{prefix:s}=u.locale,n=window.location.href.replace(`${window.location.origin}`,"");n.startsWith(s)&&(n=n.replace(s,""));let o=[],i=[];return e.forEach((a,c)=>{let g=a.prefix?`/${a.prefix}`:"",d=`${g}${n}`,f=fetch(d,{method:"HEAD"}).then(m=>{m.ok?(a.url=d,o[c]=a):t!=="off"&&(a.url=`${g}`,o[c]=a)});i.push(f)}),i.length>0&&await Promise.all(i),o.filter(a=>!!a)}function D(){let t=new URLSearchParams(window.location.search).get("georouting"),s=t||y("georouting");if(t==="off"){let n=window.location.host.endsWith(".adobe.com")?"domain=adobe.com":"",o=new Date;o.setTime(o.getTime()+365*24*60*60*1e3);let i=`expires=${o.toUTCString()}`;document.cookie=`georouting=${s};${i};path=/;${n}`}else t==="on"&&(document.cookie="georouting=; expires= Thu, 01 Jan 1970 00:00:00 GMT");return s==="off"}function C(e,t,s,n="Switch"){let o=s||"us",i=t||"us",a=`${n}:${i.split("_")[0]}-${o.split("_")[0]}|Geo_Routing_Modal`;e.setAttribute("daa-ll",a),e.addEventListener("click",()=>{let c=window.location.host==="adobe.com"||window.location.host.endsWith(".adobe.com")?"domain=adobe.com":"";document.cookie=`international=${i};path=/;${c}`,e.closest(".dialog-modal").dispatchEvent(new Event("closeModal"))})}function A(e){return e.akamaiCodes.split(",").map(t=>t.toLowerCase().trim())}function B(e,t){return e.reduce((s,n)=>(A(n).some(i=>i===t)&&s.push(n),s),[])}function O(e,t,s){let n=o=>{if(t===o)return;let i=o.target;for(;i;){if(i===e)return;i=i.parentNode}e.remove(),s.setAttribute("aria-expanded",!1),document.removeEventListener("click",n)};document.addEventListener("click",n)}function W(e,t,s,n,o,i){if(document.querySelector(".locale-modal-v2 .picker"))return;let a=r("ul",{class:"picker",dir:o});t.forEach(d=>{let f=u.locales[d.prefix]?.ietf??"",m=r("a",{lang:f,href:d.url},`${s} - ${d.language}`);C(m,d.prefix,i.prefix);let h=r("li",{},m);a.appendChild(h)}),e.parentNode.insertBefore(a,e.nextSibling);let c=e.getBoundingClientRect();window.innerHeight-c.bottom<=a.offsetHeight&&a.classList.add("top"),e.setAttribute("aria-expanded",!0),O(a,n,e)}function R(e,t,s,n){let o=new DocumentFragment,i=u.locales[t.prefix]?.ietf??"",a=u.locales[t.prefix]?.dir??"ltr",c=s.filter(v=>v.prefix===t.prefix),g=c.length?c[0][e.geo]:"",d=r("h3",{lang:i,dir:a},t.title.replace("{{geo}}",g)),f=r("p",{class:"locale-text",lang:i,dir:a},t.text),m=t.globeGrid?.toLowerCase().trim()==="on"?"globe-grid.png":`flag-${t.geo.replace("_","-")}.svg`,h=r("img",{class:"icon-milo",width:15,height:15,alt:t.button});h.addEventListener("error",()=>h.src=`${u.miloLibs||u.codeRoot}/features/georoutingv2/img/globe-grid.png`,{once:!0}),h.src=`${u.miloLibs||u.codeRoot}/img/georouting/${m}`;let l=r("span",{class:"icon margin-inline-end"},h),p=r("a",{class:"con-button blue button-l",lang:i,role:"button","aria-haspopup":!!n,"aria-expanded":!1,href:"#"},l);if(p.append(t.button),n){let v=r("img",{class:"icon-milo down-arrow",src:`${u.miloLibs||u.codeRoot}/ui/img/chevron.svg`,role:"presentation",width:15,height:15});l.appendChild(v),p.addEventListener("click",L=>{L.preventDefault(),W(p,n,t.button,L,a,e)})}else p.href=t.url,C(p,t.prefix,e.prefix);let w=r("a",{lang:i,href:e.url},e.button);C(w,e.prefix,t.prefix,"Stay");let b=r("div",{class:"link-wrapper"},p);return b.appendChild(w),o.append(d,f,b),o}async function M(e,t,s){let n=await j(t);if(!n.length)return null;let o=r("div",{class:"georouting-wrapper fragment"});if(e.url=window.location.hash?document.location.href:"#",n.length===1){let c=R(e,n[0],s);return o.appendChild(c),o}let i=n.sort((c,g)=>c.languageOrder-g.languageOrder),a=G(i.map(c=>c.language));return o.appendChild(a),i.forEach(c=>{let g=R(e,c,s,i),d=P(g,c.language);o.appendChild(d)}),o}async function S(e){let{miloLibs:t,codeRoot:s}=u,n=e.querySelector(".tabs"),o=`${t||s}/blocks/section-metadata/section-metadata.css`,i=`${t||s}/features/georoutingv2/georoutingv2.css`,a=[n?T(n):null,n?new Promise(f=>{x(o,f)}):null,new Promise(f=>{x(i,f)}),import("./modal-AN3SJQ56.js")],c=await Promise.all(a),{getModal:g,sendAnalytics:d}=c[3];return $=d,g(null,{class:"locale-modal-v2",id:"locale-modal-v2",content:e,closeEvent:"closeModal"})}async function F(e,t,s,n,o){if(D())return;u=e,r=t,k=s,T=n,x=o;let i=[`${u.contentRoot??""}/georoutingv2.json`,`${u.contentRoot??""}/georouting.json`,`${E()}/federal/georouting/georoutingv2.json`],a;for(let l of i)if(a=await fetch(l),a.ok){if(l.includes("georouting.json")){let p=await a.json(),{default:w}=await import("./georouting-RSHO26IM.js");w(u,r,k,p)}break}let c=await a.json(),{locale:g}=u,d=g.prefix.replace("/",""),f=y("international"),m=f==="us"?"":f,h=c.georouting.data.find(l=>l.prefix===d);if(h){if(m||m===""){let l=d.split("_")[0],p=m.split("_")[0];if(l!==p){let w=c.georouting.data.filter(v=>v.prefix===m),b=await M(h,w,c.geos.data);b&&(await S(b),$(new Event(`Load:${p||"us"}-${l||"us"}|Geo_Routing_Modal`)))}return}try{let l=await _();if(l&&!A(h).includes(l)){let p=B(c.georouting.data,l),w=await M(h,p,c.geos.data);w&&(await S(w),l==="gb"&&(l="uk"),$(new Event(`Load:${d||"us"}-${l||"us"}|Geo_Routing_Modal`)))}}catch(l){window.lana?.log(l.message)}}}export{F as default,y as getCookie};
