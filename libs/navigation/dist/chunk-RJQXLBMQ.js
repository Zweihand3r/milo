import{a as F}from"./chunk-JGD2XGNU.js";import{f as p,h as x,i as W,j as C,n as U}from"./chunk-7TJA6U3A.js";var D=window.screen.width<550||window.screen.height<550,A={all:()=>!0,chrome:()=>navigator.userAgent.includes("Chrome")&&!navigator.userAgent.includes("Edg"),firefox:()=>navigator.userAgent.includes("Firefox"),safari:()=>navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome"),edge:()=>navigator.userAgent.includes("Edg"),android:()=>navigator.userAgent.includes("Android"),ios:()=>/iPad|iPhone|iPod/.test(navigator.userAgent),windows:()=>navigator.userAgent.includes("Windows"),mac:()=>navigator.userAgent.includes("Macintosh"),"mobile-device":()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Touch/i.test(navigator.userAgent),phone:()=>A["mobile-device"]()&&D,tablet:()=>A["mobile-device"]()&&!D,desktop:()=>!A["mobile-device"](),loggedout:()=>!window.adobeIMS?.isSignedInUser(),loggedin:()=>!!window.adobeIMS?.isSignedInUser()},ee=Object.keys(A),_="p13n-deleted",Y="p13n-replaced",B="not ",N="target-",te="_inline",V=new URL(window.location.href),L={all:"all",includeFragments:"include-fragments"},X="personalization",ne=/[^a-z0-9\- _,&=]/g,re=["action","selector","pagefilter","page filter","page filter optional"],j={JSON:"json",TEXT:"text"},O="in-block:",h=(t,e=!0)=>{let n=t;if(!n?.includes("/"))return n;let r=p();if(n.startsWith(r.codeRoot)||n.includes(".hlx.")||n.includes(".adobe."))try{let a=new URL(n),s=a.pathname.split("/")[1];!e||r.locale.ietf==="en-US"||a.hash.includes("#_dnt")||s in r.locales||n.includes(".json")?n=a.pathname:n=`${r.locale.prefix}${a.pathname}`}catch{}else!n.startsWith("http")&&!n.startsWith("/")&&(n=`/${n}`);return n},Z=t=>t?.split("/").pop(),ae=t=>{let e=document.querySelector("body > main > div");return e===t||e?.contains(t)},se=["insertscript","replacepage","updatemetadata","useblockcode"],M={insertafter:"afterend",insertbefore:"beforebegin",prepend:"afterbegin",append:"beforeend"},$={remove:"remove",replace:"replace"};function b(t,e,n){e&&(t.dataset.manifestId=e),n&&(t.dataset.adobeTargetTestid=n)}function T(t){let e=t.toLowerCase().trim();return e.startsWith("/")||e.startsWith("http")?"fragment":"other"}var ie=(t,e,n)=>{let r=t.getAttribute("href");return n==="insertafter"||n==="append"?`${r}${e}`:n==="insertbefore"||n==="prepend"?`${e}${r}`:e},oe=(t,e,n,r,a)=>{e==="replace"&&t.classList.add(_,Y);let s=n;try{let{pathname:o,search:f,hash:d}=new URL(n);s=`${o}${f}${d}`}catch{}let i=x("a",{href:s},n);b(i,r,a);let l=x("p",void 0,i);return/#.*delay=/.test(s)&&l.classList.add("hide-block"),ae(t)&&C(`${W(i.href)}.plain.html`,{as:"fetch",crossorigin:"anonymous",rel:"preload"}),l};function J(t,e){let n=t,r=n.match(/{{(.*?)}}/g);return r&&r.forEach(a=>{let s=a.replace(/{{|}}/g,"").trim();e?.[s]&&(n=n.replace(a,e[s]))}),n}var Q=(t,{content:e,manifestId:n,targetManifestId:r,action:a,modifiers:s})=>{if(a==="replace"&&b(t,n,r),t?.nodeName==="A"&&s?.includes("href"))return t.setAttribute("href",ie(t,e,a)),b(t,n,r),t;if(T(e)!=="fragment"){let l=p(),c=J(e,l.placeholders);if(a==="replace")return t.innerHTML=c,t;let o=x("div",{},c);return b(o,n,r),o}let i=oe(t,a,e,n,r);return b(i,n,r),t?.parentElement.nodeName!=="MAIN"?i:x("div",void 0,i)},S={[$.remove]:(t,{content:e,manifestId:n})=>{if(e!=="false"){if(n){t.dataset.removedManifestId=n;return}t.classList.add(_)}},[$.replace]:(t,e)=>{!t||t.classList.contains(Y)||t.insertAdjacentElement("beforebegin",Q(t,e))}},P=(...t)=>{p().mep?.preview&&console.log(...t)},I=async(t,e=j.JSON)=>{try{let n=await fetch(h(t));if(!n.ok)throw n.status===404?new Error("File not found"):new Error(`Invalid response: ${n.status} ${n.statusText}`);return await n[e]()}catch(n){P(`Error loading content: ${t}`,n.message||n)}return null},ce=(t,e,n)=>{let r=t;r?.includes("\\")&&(r=r?.split("\\").join("/")),r?.startsWith("/")||(r=`/${r}`);let a=r?.split("/").pop();return r.startsWith("/libs/")?r=`${e}${r.replace("/libs","")}`:r=`${n}${r}`,{blockSelector:a,blockTarget:r}},le=(t,e,n=[])=>t.reduce((r,a)=>[...r,...a[e]||[]],n),q=(t,e,n={})=>t.reduce((r,a)=>(a[e]?.forEach(s=>{let{selector:i,val:l}=s;if(e==="blocks"){r[i]=l;return}if(i in r)return;let c={action:s.action,fragment:l,selector:i,manifestPath:a.manifestPath,manifestId:s.manifestId,targetManifestId:s.targetManifestId};for(let o in r)r[o].fragment===i&&(r[o]=c);r[i]=c}),{...n,...r}),{}),fe=(t,e)=>{let n=t.replace(/\*\*/g,".*");return new RegExp(`^${n}(\\.html)?$`,"i").test(e)};async function de(t,e){if(!t||!e)return!1;let n=t.endsWith("/")?`${t}index`:t;n=n.endsWith(".plain.html")?n:`${n}.plain.html`;let r=await I(n,j.TEXT);if(!r)return!1;e.innerHTML=r;let{decorateArea:a}=p();return a&&a(e),!0}var ue=t=>{let{selector:e,val:n}=t;if(!e||!n)return;let r=e.startsWith("og:")?"property":"name",a=document.querySelector(`meta[${r}="${e}"]`);a||(a=x("meta",{[r]:e}),document.head.append(a)),a.setAttribute("content",n)};function me(t){return t.toLowerCase().replace(ne,"")}function pe(t){return Object.keys(t).reduce((e,n)=>(e[me(n)]=t[n],e),{})}function he(t){let e=t.selector.substring(O.length).trim().split(/\s+/),[n]=e,r=p();r.mep.inBlock??={},r.mep.inBlock[n]??={};let a;if(e.length===1&&delete t.selector,e.length>1&&(a=e.slice(1).join(" "),t.selector=a,T(a)==="fragment")){r.mep.inBlock[n].fragments??={};let{fragments:s}=r.mep.inBlock[n];if(delete t.selector,a in s)return;for(let i in s)s[i].content===a&&(s[i]=t);s[a]=t,a=h(a);for(let i in s)s[i].content===a&&(s[i]=t);s[a]=t;return}r.mep.inBlock[n].commands??=[],r.mep.inBlock[n].commands.push(t)}var K=(t,e)=>t?e.replace(t,`:nth-child(${t})`):e;function ge(t){let e=t,n={section:"main > div","primary-cta":"strong a","secondary-cta":"em a","action-area":"*:has(> em a, > strong a)","any-marquee-section":'main > div:has([class*="marquee"])',"any-marquee":'[class*="marquee"]',"any-header":":is(h1, h2, h3, h4, h5, h6)"},r=["row","col"],a=["html","body","header","footer","main","div","a","p","strong","em","picture","source","img","h","ul","ol","li"],s=e.match(/^[a-zA-Z/./-]*/),i=s?s[0].toLowerCase():"",l=i.split(/\.|:/)[0],c=e.match(/[0-9]*$/),o=c&&i.match(/^[a-zA-Z]/)?c[0]:"";return!i||a.includes(i)?e:r.includes(i)?(e=e.replace(i,"> div"),e=K(o,e),e):Object.keys(n).includes(l)?(e=e.replace(l,n[l]),e=K(o,e),e):(i.startsWith(".")||(e=`.${e}`),o&&(e=e.replace(o,""),e=`${e}:nth-child(${o} of ${e})`),e)}function Ee(t){let e=t,n=[],r=e.split(/\s+#_/);return r.length&&(e=r.shift(),r.forEach(a=>{a.split(/_|#_/).forEach(s=>n.push(s.toLowerCase().trim()))})),{sel:e,modifiers:n}}function ye(t){let{sel:e,modifiers:n}=Ee(t);return{modifiedSelector:e.split(">").join(" > ").split(",").join(" , ").replaceAll(/main\s*>?\s*(section\d*)/gi,"$1").split(/\s+/).map(ge).join(" ").trim(),modifiers:n}}function we(t,e,n){let r=n?e:document,a=t.trim();if(!a)return{};if(T(a)==="fragment")try{return{els:r.querySelectorAll(`a[href*="${h(a,!1)}"], a[href*="${h(a,!0)}"]`),modifiers:[L.all,L.includeFragments]}}catch{return{els:[],modifiers:[]}}let{modifiedSelector:s,modifiers:i}=ye(a),l;try{l=r.querySelectorAll(s)}catch{return P("Invalid selector: ",a),null}return i.includes(L.all)||!l.length?{els:l,modifiers:i}:(l=[l[0]],{els:l,modifiers:i})}var be=(t,e)=>{if(!e)return t;try{let{origin:n,pathname:r,search:a}=new URL(t);return`${n}${r}${a}#${e}`}catch{return`${t}#${e}`}},G=(t,e,n)=>{[...t[0].children].forEach(r=>r.dataset[e]=n)},ve=(t,e,n,r)=>{let{manifestId:a,adobeTargetTestid:s}=t.dataset;e?(a&&G(n,"manifestId",a),s&&G(n,"adobeTargetTestid",s)):b(r,a,s)};function Pe(t,e,n=!1,r=!1){return t.forEach(a=>{let{action:s,content:i,selector:l}=a;if(a.content=n?be(i,te):i,l.startsWith(O)){he(a),a.selectorType=O;return}let{els:c,modifiers:o}=we(l,e,r);a.modifiers=o,c?.forEach(f=>{if(!f||!(s in S)&&!(s in M)||e&&!e.contains(f))return;if(s in S){S[s](f,a);return}(T(l)==="fragment"?f.parentElement:f)?.insertAdjacentElement(M[s],Q(f,a))}),(c.length&&!a.modifiers.includes(L.all)||!a.modifiers.includes(L.includeFragments))&&(a.completed=!0)}),t.filter(a=>!a.completed&&a.selectorType!==O)}var xe=(t,e,n,r,a)=>{let s=p(),i=Z(r),l=i.replace(".json","");a&&(l=a),s.mep?.preview||(i=!1);let c=t.action?.toLowerCase().replace("content","").replace("fragment","").replace("tosection","");if(!c){P("Row found with empty action field: ",t);return}let o=t["page filter"]||t["page filter optional"],{selector:f}=t;if(o&&!fe(o,new URL(window.location).pathname))return;s.mep?.preview||(i=!1);let{origin:d}=V;e.forEach(u=>{let g=u.startsWith(N)?l:!1;if(!t[u]||t[u].toLowerCase()==="false")return;let E={action:c,selector:f,pageFilter:o,content:t[u],selectorType:T(f),manifestId:i,targetManifestId:g};if(c in S&&E.selectorType==="fragment")n[u].fragments.push({selector:h(E.selector.split(" #_")[0]),val:h(t[u]),action:c,manifestId:i,targetManifestId:g});else if(se.includes(c))if(n[u][c]=n[u][c]||[],c==="useblockcode"){let{blockSelector:y,blockTarget:R}=ce(t[u],s.miloLibs,d);n[u][c].push({selector:y,val:R,pageFilter:o,manifestId:i,targetManifestId:g})}else n[u][c].push({selector:h(f),val:h(t[u]),pageFilter:o,manifestId:i,targetManifestId:g});else(c in S||c in M)&&n[u].commands.push(E)})};function Ae(t,e,n){if(!t?.length)return null;let r={},a=t.map(s=>pe(s));try{let s={},i=Object.keys(a[0]).filter(c=>!re.includes(c));return i.forEach(c=>{s[c]={commands:[],fragments:[]}}),a.forEach(c=>{xe(c,i,s,e,n)}),r.variants=s,r.variantNames=i,p().mep?.preview||(r.manifestId=!1),r}catch(s){P("error parsing personalization manifestConfig:",s,a)}return null}async function Le(t,e,n){e.locale.ietf!=="en-US"&&await import("./attributes-ZXK62QJ5.js").then(({processTrackingLabels:r})=>{e.mep.analyticLocalization??={},t.forEach((a,s)=>{let i=t[s],l=i["en-us"]||i.us||i.en||i.key;if(!l)return;l=r(l);let c=r(a[n]);e.mep.analyticLocalization[c]=l})})}function Se(t,e,n=""){if(!t?.length||n==="default")return e;let r=[n.toLowerCase(),e.mep?.geoPrefix,e.locale.region.toLowerCase(),e.locale.ietf.toLowerCase(),...e.locale.ietf.toLowerCase().split("-"),"value","other"],i=(t?.length?Object.entries(t[0]):[]).find(([l])=>r.includes(l.toLowerCase()))?.[0];if(i){let l=t.reduce((c,o)=>(c[o.key]=o[i],c),{});e.placeholders={...e.placeholders||{},...l}}return Le(t,e,i),e}var Te=t=>{let[e,n]=t.split("param-")[1].split("=");if(!e)return!1;let a=new URLSearchParams(Array.from(V.searchParams,([s,i])=>[s.toLowerCase(),i?.toLowerCase()])).get(e.toLowerCase());return a!==null?n?n===a:!0:!1};function H(t){return t.map(e=>e.trim()).filter(Boolean)}function Oe(t){return t.reduce((e,n)=>{let r=[n];return n.startsWith(N)||(r=n.split(",")),e[n]=H(r),e.allNames=[...e.allNames,...H(n.split(/[,&]|\bnot\b/))],e},{allNames:[]})}async function $e(t,e=[],n=null){let r=p();if(r.mep?.variantOverride?.[t])return r.mep.variantOverride[t];let a=Oe(e),i=Object.values(await F()).some(d=>a.allNames.includes(d)),l=[];i&&(l=await r.entitlements());let c=d=>d===""||d===n?.toLowerCase()?!0:d.startsWith("param-")?Te(d):l?.includes(d)?!0:ee.includes(d)&&A[d](),o=d=>d.startsWith(N)?c(d):!d.split("&").map(g=>{let E=g.trim().startsWith(B),y=c(g.replace(B,"").trim());return E?!y:y}).includes(!1);return e.find(d=>a[d].some(o))}var Ne=t=>({disabled:t.disabled,event:t.event,manifest:t.manifestPath,executionOrder:"1-1",selectedVariant:{commands:[],fragments:[]},selectedVariantName:"default",variantNames:["all"],variants:{}}),De=(t,e)=>{t.mep.experiments.forEach(n=>{n?.selectedVariant?.useblockcode?.forEach(({selector:r,targetManifestId:a})=>{r&&a&&document.querySelectorAll(`.${r}`).forEach(s=>s.dataset.adobeTargetTestid=a)}),e&&n?.selectedVariant?.updatemetadata?.forEach(r=>{r?.selector==="gnav-source"&&r.targetManifestId&&(e.dataset.adobeTargetTestid=r.targetManifestId)})})};async function ke(t={},e=!1){let{name:n,manifestData:r,manifestPath:a,manifestUrl:s,manifestPlaceholders:i,manifestInfo:l,variantLabel:c,disabled:o,event:f}=t;if(o&&(!e||!Object.keys(e).length))return Ne(t);let d=r;if(!d){let w=await I(a,j.JSON);I&&(d=w)}let u=d?.experiences?.data||d?.data||d;if(!u)return null;let g=l||d?.info?.data,E=g?.reduce((w,v)=>(w[v.key]=v.value,w),{}),y=E?.["manifest-override-name"]?.toLowerCase(),m=Ae(u,a,n||y);if(!m)return P("Error loading personalization manifestConfig: ",n||a),null;let k={"manifest-type":["Personalization","Promo","Test"],"manifest-execution-order":["First","Normal","Last"]};if(g){m.manifestType=E?.["manifest-type"]?.toLowerCase(),y&&m.manifestType===X&&(m.manifestOverrideName=y);let w={"manifest-type":1,"manifest-execution-order":1};Object.keys(E).forEach(v=>{if(!k[v])return;let z=k[v].indexOf(E[v]);w[v]=z>-1?z:1}),m.executionOrder=`${w["manifest-execution-order"]}-${w["manifest-type"]}`}else m.manifestType=k["manifest-type"][1],m.executionOrder="1-1";return m.manifestPath=h(a),m.selectedVariantName=await $e(m.manifestPath,m.variantNames,c),m.placeholderData=i||d?.placeholders?.data,m.name=n,m.manifest=a,m.manifestUrl=s,m.disabled=o,m.event=f,m}var Ce=(t=document)=>{[...t.querySelectorAll(`.${_}`)].forEach(e=>e.remove())},Me=({selector:t,val:e,action:n,manifestId:r,targetManifestId:a})=>({selector:h(t),val:h(e),action:n,manifestId:r,targetManifestId:a});async function Ie(t,e){if(!t)return null;let{manifestPath:n,selectedVariant:r}=t;if(!r||r==="default")return{experiment:t};let{replacepage:a}=r;return r.replacepage?.length&&(e.mep.replacepage=a[0]),r.insertscript?.map(s=>U(s.val)),r.updatemetadata?.map(s=>ue(s)),r.fragments&&=r.fragments.map(Me),{manifestPath:n,experiment:t,blocks:r.useblockcode,fragments:r.fragments,commands:r.commands}}function _e(t){if(!t)return!1;let e=Object.create(null);return decodeURIComponent(t).split("---").forEach(r=>{let a=r.trim().split("--");if(a.length>1){let[s,i]=a;e[s]=i}}),e}function Ve(t,e){return t.executionOrder===e.executionOrder?0:t.executionOrder>e.executionOrder?1:-1}function je(t){let e=p(),n={},r=t;return e.mep?.experiments&&(r=[...t,...e.mep.experiments]),r.forEach(a=>{try{if(!a?.manifest)return;if(a.manifestPath||(a.manifestPath=h(a.manifest)),a.manifestPath in n){let o=n[a.manifestPath],f=a;a.name&&(o=a,f=n[a.manifestPath]),f.name=o.name,f.selectedVariantName=o.selectedVariantName,f.selectedVariant=f.variants[f.selectedVariantName],n[a.manifestPath]=f}else n[a.manifestPath]=a;let s=n[a.manifestPath],{selectedVariantName:i,variantNames:l,placeholderData:c}=s;i&&l.includes(i)?(s.run=!0,s.selectedVariantName=i,s.selectedVariant=s.variants[i]):(s.selectedVariantName="default",s.selectedVariant="default"),Se(c,p(),s.selectedVariantName)}catch(s){P(`MEP Error parsing manifests: ${s.toString()}`),window.lana?.log(`MEP Error parsing manifests: ${s.toString()}`)}}),Object.keys(n).forEach(a=>{delete n[a].variants}),Object.values(n).sort(Ve)}function Be(t,e){let{action:n,fragment:r,manifestId:a,targetManifestId:s}=t;return n===$.replace?(e.href=r,b(e,a,s),r):(n===$.remove&&(a?e.parentElement.dataset.removedManifestId=a:e.parentElement.remove()),!1)}function Re({placeholders:t}){t&&Object.entries(t).forEach(([e,n])=>{t[e]=J(n,t)})}async function ze(t,e=!1){if(!t?.length)return;let n=t,r=p();for(let o=0;o<n.length;o+=1)n[o]=await ke(n[o],r.mep?.variantOverride);n=je(n),Re(r);let a=[];for(let o of n){let f=await Ie(o,r);f&&a.push(f)}a=a.filter(Boolean),r.mep.experiments=[...r.mep.experiments,...n],r.mep.blocks=q(a,"blocks",r.mep.blocks),r.mep.fragments=q(a,"fragments",r.mep.fragments),r.mep.commands=le(a,"commands",r.mep.commands);let s=document.querySelector("main");if(r.mep.replacepage&&!e&&s){await de(r.mep.replacepage.val,s);let{manifestId:o,targetManifestId:f}=r.mep.replacepage;b(s,o,f)}e||(r.mep.commands=Pe(r.mep.commands)),Ce();let i=a.filter(o=>o.experiment?.manifestType===X);if(!i.length)return;let l=i.map(o=>{let f=o.experiment.selectedVariantName.replace(N,"").trim().slice(0,15);return f==="default"?"nopzn":f}),c=i.map(o=>{let f=o.experiment?.manifestOverrideName||o.experiment?.manifest;return Z(f).replace(".json","").trim().slice(0,15)});r.mep.martech=`|${l.join("--")}|${c.join("--")}`}var Fe=async(t,e,n)=>{let r=[];if(t&&(r=t.toLowerCase().split(/,|(\s+)|(\\n)/g).filter(a=>a?.trim()).map(a=>({manifestPath:a}))),e){let{default:a}=await import("./promo-utils-ZVRLSKKJ.js");r=r.concat(a(e,V.searchParams))}if(n&&n!=="off"){let a=r.map(s=>{let{manifestPath:i}=s;if(i.startsWith("/"))return i;try{return new URL(i).pathname}catch{return i}});n.split("---").forEach(s=>{let i=s.trim().toLowerCase().split("--")[0];a.includes(i)||r.push({manifestPath:i})})}return r};async function qe(t={}){let e=[],{mepParam:n,mepHighlight:r,mepButton:a,pzn:s,promo:i,target:l,postLCP:c}=t,o=p();if(c||(o.mep={updateFragDataProps:ve,preview:a!=="off"&&(o.env?.name!=="prod"||n||n===""||a),variantOverride:_e(n),highlight:r!==void 0&&r!=="false",targetEnabled:l,experiments:[],geoPrefix:o.locale?.prefix.split("/")[1]?.toLowerCase()||"en-us"},e=e.concat(await Fe(s,i,n)),e?.forEach(f=>{if(f.disabled)return;let d=h(f.manifestPath);C(d,{as:"fetch",crossorigin:"anonymous",rel:"preload"})})),l===!0||l==="gnav"&&c){let{getTargetPersonalization:f}=await import("./martech-TGEEZZR2.js"),{targetManifests:d,targetPropositions:u}=await f();e=e.concat(d),u?.length&&window._satellite&&window._satellite.track("propositionDisplay",u)}try{await ze(e,c)}catch(f){P(`MEP Error: ${f.toString()}`),window.lana?.log(`MEP Error: ${f.toString()}`)}}export{A as a,X as b,h as c,Z as d,J as e,Q as f,fe as g,de as h,ye as i,ve as j,Pe as k,Ae as l,Le as m,Se as n,Oe as o,De as p,ke as q,Ce as r,Ie as s,je as t,Be as u,Re as v,ze as w,Fe as x,qe as y};
