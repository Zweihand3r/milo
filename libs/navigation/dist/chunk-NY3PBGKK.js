import{f as h,v as d}from"./chunk-VP5VJMKQ.js";var i={};window.mph={};var g=(e,a)=>{let n=`${e.locale.contentRoot}/placeholders.json`,l=a!=="default"&&typeof a=="string"&&a.length?`?sheet=${a}`:"";return`${n}${l}`},f=async({config:e,sheet:a,placeholderRequest:n,placeholderPath:l})=>{let c=l||g(e,a);return i[c]=i[c]||new Promise(async o=>{let s=await n||await d({resource:c,withCacheRules:!0}).catch(()=>({})),u=s.ok?await s.json():{data:[]};if(u.data.length===0){o({});return}let t={};u.data.forEach(r=>{window.mph[r.key]=r.value,t[r.key]=r.value}),o(t)}),i[c]};function y(e){return e.replaceAll("-"," ")}async function w(e,a,n){let l=!1,c="en-US",o=()=>{let t=a.locale.contentRoot,r=a.locale.prefix;return r.length?t.endsWith(r)?t.replace(r,""):t.replace(`${r}/`,"/"):t},s=async()=>{let t={locale:{ietf:c,contentRoot:o()}},r=await f({config:t,sheet:n}).catch(()=>({}));return l=!0,r};if(a.placeholders?.[e])return a.placeholders[e];let u=await f({config:a,sheet:n}).catch(async()=>await s());if(typeof u?.[e]=="string")return u[e];if(!l&&a.locale.ietf!==c){let t=await s();if(t?.[e])return t[e]}return y(e)}async function A(e,a,n="default"){return typeof e!="string"||!e.length?"":await w(e,a,n)}async function P(e,a,n="default"){if(!Array.isArray(e)||!e.length)return[];let l=[];return e.forEach(o=>{l.push(w(o,a,n))}),await Promise.all(l)}async function p(e,a,n=/{{(.*?)}}|%7B%7B(.*?)%7D%7D/g,l="default"){if(typeof e!="string"||!e.length)return"";let c=[...e.matchAll(new RegExp(n))];if(!c.length)return e;let o=Array.from(c,r=>r[1]||r[2]),s=await P(o,a,l),u=0,t=e.replaceAll(n,()=>s[u++]);return t=t.replace(/&nbsp;/g,"\xA0"),t}async function T({placeholderPath:e,placeholderRequest:a,nodes:n}){if(!n.length)return;let l=h();await f({placeholderPath:e,config:l,placeholderRequest:a});let c=n.map(async o=>{if(o.nodeType===Node.TEXT_NODE)o.nodeValue=await p(o.nodeValue,l);else if(o.nodeType===Node.ELEMENT_NODE){let s=[...o.attributes].map(async t=>{let r=await p(t.value,l);return{name:t.name,value:r}});(await Promise.all(s)).forEach(({name:t,value:r})=>{o.setAttribute(t,r)})}});await Promise.all(c)}export{A as a,P as b,p as c,T as d};
