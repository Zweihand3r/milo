import{c as d}from"./chunk-KHBABMXA.js";import"./chunk-YBWLHNHN.js";var A=e=>[...e.childNodes].some(({nodeType:t,textContent:n})=>t===Node.TEXT_NODE&&n.trim()!=="");function g(e=document.body){let t=e.tagName.toLowerCase();return t==="header"||t==="footer"||e.classList.contains("jpwordwrap-disabled")?[]:Array.from(e.children).reduce((n,s)=>A(s)?[...n,s]:[...n,...g(s)],[])}function h(e,t,n,s="#"){let r=t.indexOf(s);if(r===-1){console.warn("No marker symbol found in the line break pattern string");return}r!==t.lastIndexOf("#")&&console.warn("Two or more marker symbols cannot be specified. Only the first marker is applied");let l=t.slice(Math.max(r-3,0),r),a=t.slice(r+1,Math.min(r+4,t.length));if(l.length<2||a.length<2){console.warn("At least two characters must be specified before and after the marker symbol");return}l.length===3?e.model.set(`TW1:${l}`,n):l.length===2&&e.model.set(`BW1:${l}`,n),a.length===3?e.model.set(`TW4:${a}`,n):a.length===2&&e.model.set(`BW3:${a}`,n)}function E(e){let t=getComputedStyle(e);return t.display==="flex"||t.display==="grid"}function y(){return navigator.userAgent.includes("Firefox")}function B(e){return!!e.querySelector("wbr")}function W(e){return!!e.querySelector("wbr[class^=jpn-balanced-wbr]")}async function T(e,t={}){let{miloLibs:n,codeRoot:s}=e,{scopeArea:r=document,budouxThres:l=2e3,bwEnabled:a=!1,budouxExcludeSelector:c=null,bwExcludeSelector:i="p",lineBreakOkPatterns:k=[],lineBreakNgPatterns:S=[]}=t,p=n||s,{loadDefaultJapaneseParser:j}=await import(`${p}/deps/budoux-index-ja.min.js`),f=j(),b=g(r instanceof Document?r.body:r),m=new Set,w=new Set;c&&r.querySelectorAll(c).forEach(o=>{m.add(o)}),a&&i&&r.querySelectorAll(i).forEach(o=>{w.add(o)});let x=Number.MAX_VALUE;if(k.forEach(o=>{h(f,o,x)}),S.forEach(o=>{h(f,o,-x)}),b.forEach(o=>{m.has(o)||B(o)||y()&&E(o)||f.applyElement(o,{threshold:l})}),a){let o=(await import(`${p}/deps/bw2.min.js`)).default,N=new o;b.forEach(u=>{w.has(u)||W(u)||y()&&E(u)||N.applyElement(u)})}}async function O(e,t=document){let n=d("jpwordwrap:disabled")==="true"||!1,s=Number(d("jpwordwrap:budoux-thres"))||2e3,r=d("jpwordwrap:budoux-exclude-selector"),l=d("jpwordwrap:bw-enabled")==="true"||!1,a=d("jpwordwrap:bw-exclude-selector")||"p",c=(d("jpwordwrap:line-break-ok")||"").split(","),i=(d("jpwordwrap:line-break-ng")||"").split(",");n||await T(e,{scopeArea:t,budouxThres:s,budouxExcludeSelector:r,bwEnabled:l,bwExcludeSelector:a,lineBreakOkPatterns:c,lineBreakNgPatterns:i})}export{T as applyJapaneseLineBreaks,O as default,W as isBalancedWordWrapApplied,B as isWordWrapApplied};
